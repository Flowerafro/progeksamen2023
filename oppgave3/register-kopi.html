<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESTERStaff register</title>
    <link href="style.css" rel="stylesheet" media="screen" />
</head>
<body>
    <header>
        <h1>Staff Register</h1>
    </header>
    <main>
        <section id="list">
            <nav id="filter">
                <p>Filter on position:</p>
                <ul id="positionFilter">
                    <li><button class="all active">All positions</button></li>
                </ul>
            </nav>
            <h2 id="listHeader">Showing all Staff</h2>
            <div id="staffList">
                
            </div>
        </section>
        <section id="admin">
            <div class="form">
                <h2>Add staff</h2>
                <p>
                    <label for="firstname">Firstname</label>
                    <input type="text" name="firstname" id="firstname" placeholder="Firstname"/>
                </p>
                <p>
                    <label for="lastname">Lastname</label>
                    <input type="text" name="lastname" id="lastname" placeholder="Lastname"/></p>
                <p>
                    <label for="position">Position</label>
                    <select id="position" name="position">
                       
                    </select>
                </p>
                <p>
                    <label for="department">Department</label>
                    <select id="department" name="department">
                        
                    </select>
                </p>
                <p>
                    <label for="email">Email address</label>
                    <input type="email" name="email" id="email" placeholder="you@email.com"/></select>
                </p>
                <button id="saveStaff">Save staff member</button>
            </div>
            <div class="form">
                <h2>Add position</h2>
                <p>
                    <label for="newPosition">Position</label>
                    <input type="text" name="newPosition" id="newPosition" placeholder="Position" />
                </p>
                <button id="savePosition">Save new position</button>
            </div>
            <div class="form">
                <h2>Add department</h2>
                <p>
                    <label for="newDepartment">Department</label>
                    <input type="text" name="newDepartment" id="newDepartment" placeholder="Department" />
                </p>
                <button id="saveDepartment">Save new department</button>
            </div>
        </section>
    </main>

   <script>
        //Array of staff objects
        const staff = [
            {firstname: "Bill", lastname: "Gates", position: "Director", department: "Administration", email: "bill@gates.net"},
        ]
        //Array of available positions
        const positions = ["Director", "Team leader", "Producer", "Engineer", "Designer"]

        //Array of available departments
        const departments = ["Administration", "Human Resources", "Production", "Finances"]

    /* ---------------------- KODE skrevet av kandidat XXX ------------------ */

    /* ------------  Krav D: Punkt 1) Stillinger og avdelinger i nedtrekksmeny i HTMl sorteres ------------- */
        // kode for å gjøre position-nedtrekkmeny synlig i html (MÅ ENDRES)
        positions.sort().map(showPosition => document.getElementById("position").innerHTML = ` 
        <select id="position" name="position">
        <option>${positions[0]}</option>
        <option>${positions[1]}</option>
        <option>${positions[2]}</option>
        <option>${positions[3]}</option>
        <option>${positions[4]}</option>
        </select>`)

        // kode for å gjøre department-nedtrekksmenyen synlig i html (MÅ ENDRES)
   departments.sort().map(showDepartment => document.getElementById("department").innerHTML = `
        <select id="department" name="department">
        </select>
        `)
 
        /* ------------  Krav E: Punkt 1) Kode til å liste opp ansatte (staff.array) i ansattliste  ------------- */ 
    staff.sort((a, b) => a.lastname.localeCompare(b.lastname)).map(staff => document.getElementById("staffList").innerHTML += `
        <article class="membercard">
        <h3>${staff.lastname}, ${staff.firstname}</h3>
        <p class="metainfo">
            <img src="posicon.png" alt="position: ">${staff.position}
            <img src="depicon.png" alt="department: ">${staff.department}
        </p><p><a href="mailto:${staff.email}">
            <img src="mailicon.png"> Send mail to ${staff.firstname}</a>
        </p></article>`) 

        /* ------------  Krav E Punkt 2) Registrere nye ansatte gjennom HTML-skjema ------------- */
        // variabel for å finne Save Staff Member-knapp
        const addStaffBtn = document.getElementById("saveStaff")
        // Kode til å lokalisere ansattliste i HTML
        const staffList = document.getElementById("staffList")
        // variabler for å finne elementer i input-felt
        const firstName = document.getElementById("firstname")
        const lastName = document.getElementById("lastname")
        const position = document.getElementById("position")
        const department = document.getElementById("department")
        const email = document.getElementById("email")

        //funksjon som skal registrere nye ansatte 
        function registerStaff () {        
            // rydder vekk staffList
            document.getElementById("staffList").innerHTML = "";
            // sender informasjon fra input-felt til array i koden
            staff.push({firstname:firstName.value, lastname: lastName.value, position: position.value, department: department.value, email: email.value});
            //  Sortere etter etternavn / lastname før mapper ut arrayet (sender til staffList) 
        staff.sort((a, b) => a.lastname.localeCompare(b.lastname)).map(staff => document.getElementById("staffList").innerHTML += `
        <article class="membercard">
        <h3>${staff.lastname}, ${staff.firstname}</h3>
        <p class="metainfo">
            <img src="posicon.png" alt="position: ">${staff.position}
            <img src="depicon.png" alt="department: ">${staff.department}
        </p><p><a href="mailto:${staff.email}">
            <img src="mailicon.png"> Send mail to ${staff.firstname}</a>
        </p></article>`) 

        console.log(staff);
        }

        /* ----- Mål: Ikke kunne registere nye ansatte dersom noen av feltene fornavn, etternavn eller epost er tomme ---- */
        // If-testen sjekker om verdiene i inputfeltene er tomme eller har null-verdi
        const addStaffMember = (e) => {
            e.preventDefault();
            if (
                firstName.value === "" || 
                firstName.value == null ||
                lastName.value === "" ||
                lastName.value == null || 
                position.value === "" ||
                position.value == null ||
                department.value === "" ||
                department.value == null || 
                email.value === "" ||
                email.value == null 
                ) {
                    // dersom noen inputfelt er tomme eller har null-verdi skal denne alerten dukke opp
                    alert("Please fill out all boxes")
            } else {
                // hvis ingen felt har null eller er tomme, skal registerStaff-funksjonen kjøre
                registerStaff();
                // Kode som rydder ut fra inputfeltene, som aktiveres av addEventListner under 
                const inputCleared = document.querySelectorAll("#firstname, #lastname, #email, #position, #department");
                inputCleared.forEach(input => {
                input.value = "";
            })
        }}
        // addEventListner til Save staff member-knapp som starter if-test i addStaffmember og deretter registerStaff
        addStaffBtn.addEventListener("click", addStaffMember)


        /* ----- D-krav Punkt 2&3) nye avdelinger opprettes i HTML-skjemaet og blir synlig i nedtrekksmeny  -----  */

        //variabel for å finne Save new department-knapp
        const addDepartmentBtn = document.getElementById("saveDepartment")
        // Kode for å lokalisere departmen-liste i HTML
        const departmentList = document.getElementById("department")
        // Variabel for å finne element i inputfelt
        let departmentInput = document.getElementById("newDepartment")

        //funksjon som skal legge til ny avdeling
        function newDepartment() {    
            // tømme dropdown-meny
            departmentList.value = "";
            // sender info fra inpultfelt
            departments.push(departmentInput.value);
            //sortere array
            const sortedDepartment = departments.sort((a, b) => a > b)
            // sende verdier til HTML
            for(var i = 0; i < departments.length; i++) {
            var opt = departments[i];
            var el = document.createElement("option");
            el.textContent = opt;
            el.value = opt;
            department.appendChild(el);
            }

       /*      departments.forEach((dept) => {
                let o = document.createElement("option");
                o.text = dept.name;
                o.value = dept.goals;
                department.appendChild(o);
            }) */
            
         /*    for(let i = 0; i < departments.length; i++) {
                let element = document.createElement("option");
                element.textContent = departmentInput.value;
                element.value = departmentInput.value;
                department.appendChild(element);
            } */

        /*     for(let i = 4; i < departments.length; i++) {

                let dept = departments[i];
                let element = document.createElement("option");
                element.textContent = departmentInput.value;
                element.value = dept;
                department.appendChild(element);
           
            /*
            for(let addDept = 0; addDept <= 10; addDept++) {
                departments += `<option>${departmentInput.value}</option>`
            }
            document.getElementById("department").innerHTML = departments */
      /*   document.getElementById("department").innerHTML = `
        <select id="department" name="department">
        <option>${departments[0]}</option>
        <option>${departments[1]}</option>
        <option>${departments[2]}</option>
        <option>${departments[3]}</option>
        <option>${departments[4]}</option>
        </select>`; */
            // rydder vekk array for å få plass til oppdatert array
            departmentInput.value = "";
            // konsollogg viser at det legges til i array
            console.log(departments);
        
    }
        //addEventlistner til Save New Department-knapp
        addDepartmentBtn.addEventListener("click", newDepartment)

       
        /* --------------C-krav: Nye stillinger opprettes i HTML-skjemaet-------------- */

        //variabel for å finne Save New position-knapp
        const addPositionBtn = document.getElementById("savePosition")
        //funksjon for å sende verdi fra #newPosition til array positions, Filter on Positions og nedtrekksliste
        function newPosition() {
            //Hente verdi / info som legges inn i input:
            const addNewPosition = document.getElementById("newPosition").value
            //Skrive ut verdi til nedtrekkskjema og gjøre den synlig
            document.getElementById("position").innerHTML += `<option>${addNewPosition}</option>`
            //Skrive ut verdi til Filter on position (over ansattliste)
            document.getElementById("positionFilter").innerHTML += `<li><button>${addNewPosition}</button></li>`
            //legge til verdi til array
            positions.push(addNewPosition);
            //konsollogg viser at det legges til i array
            console.log(positions);
        }
        //addEventlistner til Save New Position-knapp
        addPositionBtn.addEventListener("click", newPosition)

        console.log(staff);
    </script>
</body>
</html>